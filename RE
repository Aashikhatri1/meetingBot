import ctypes
from screeninfo import get_monitors
import os

def change_screen_resolution(width, height):
    # Change screen resolution
    user32 = ctypes.windll.user32
    user32.ChangeDisplaySettingsW(None, 0)
    DM_BITSPERPEL = 0x00040000
    DM_PELSWIDTH = 0x00080000
    DM_PELSHEIGHT = 0x00100000
    DM_SIZE = 0x001C0000

    mode = user32.DEVMODEW()
    mode.dmSize = ctypes.sizeof(user32.DEVMODEW)
    mode.dmPelsWidth = width
    mode.dmPelsHeight = height
    mode.dmBitsPerPel = 32
    mode.dmFields = DM_BITSPERPEL | DM_PELSWIDTH | DM_PELSHEIGHT

    if user32.ChangeDisplaySettingsW(ctypes.byref(mode), 0) != 0:
        raise Exception("Failed to change screen resolution")

def main():
    original_resolution = get_monitors()[0]
    try:
        change_screen_resolution(1920, 1080)  # Change this to your desired resolution
        # Call your code here
        os.system('python zoombot.py https://us04web.zoom.us/j/2349397688?pwd=SWRGSElROXlwc2xQdG93REFDdm1iUT09')
    finally:
        # Always restore the original resolution
        change_screen_resolution(original_resolution.width, original_resolution.height)

if __name__ == "__main__":
    main()
